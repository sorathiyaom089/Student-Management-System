{% extends "base.html" %}

{% block title %}Fee Management - Admin Panel{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Fee Management</h1>
    <div class="header-actions">
        <a href="{{ url_for('admin_add_fee') }}" class="btn btn-primary">Add Fee Record</a>
        <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
    </div>
</div>

<div class="stats-container">
    <div class="stat-card">
        <h3>Total Fees</h3>
        <p class="stat-number">₹{{ "{:,.2f}".format(stats.total_fees) }}</p>
    </div>
    
    <div class="stat-card">
        <h3>Total Collected</h3>
        <p class="stat-number" style="color: #27ae60;">₹{{ "{:,.2f}".format(stats.total_paid) }}</p>
    </div>
    
    <div class="stat-card">
        <h3>Total Pending</h3>
        <p class="stat-number" style="color: #e74c3c;">₹{{ "{:,.2f}".format(stats.total_pending) }}</p>
    </div>

    <div class="stat-card">
        <h3>Pending Records</h3>
        <p class="stat-number">{{ stats.pending_count }}</p>
    </div>
</div>

<div class="table-container">
    <h2>Fee Records</h2>
    <table class="data-table">
        <thead>
            <tr>
                <th>Fee ID</th>
                <th>Student Name</th>
                <th>Program</th>
                <th>Semester</th>
                <th>Fee Type</th>
                <th>Total Amount</th>
                <th>Paid</th>
                <th>Balance</th>
                <th>Due Date</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for fee in fees %}
            <tr>
                <td>{{ fee.fee_id }}</td>
                <td>{{ fee.first_name }} {{ fee.last_name }}</td>
                <td>{{ fee.program }}</td>
                <td>{{ fee.semester }}</td>
                <td>{{ fee.fee_type }}</td>
                <td>₹{{ "{:,.2f}".format(fee.total_amount) }}</td>
                <td>₹{{ "{:,.2f}".format(fee.paid_amount) }}</td>
                <td>₹{{ "{:,.2f}".format(fee.balance) }}</td>
                <td>{{ fee.due_date }}</td>
                <td>
                    <span class="badge badge-{{ 'success' if fee.status == 'Paid' else ('warning' if fee.status == 'Partial' else 'danger') }}">
                        {{ fee.status }}
                    </span>
                </td>
                <td>
                    <a href="{{ url_for('admin_add_payment', fee_id=fee.fee_id) }}" class="btn btn-sm btn-primary">Add Payment</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<style>
    .stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        text-align: center;
    }

    .stat-card h3 {
        color: #7f8c8d;
        font-size: 14px;
        margin-bottom: 10px;
        text-transform: uppercase;
    }

    .stat-number {
        font-size: 32px;
        font-weight: bold;
        color: #3498db;
        margin: 0;
    }

    .badge-danger {
        background-color: #e74c3c;
        color: white;
    }

    .badge-warning {
        background-color: #f39c12;
        color: white;
    }
</style>
{% endblock %}
